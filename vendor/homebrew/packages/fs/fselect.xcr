formula = r"""
class Fselect < Formula
  desc "Find files with SQL-like queries"
  homepage "https://github.com/jhspetersson/fselect"
  url "https://github.com/jhspetersson/fselect/archive/0.7.6.tar.gz"
  sha256 "bea8a7c09ddb88a8ad253305744847c4e4d63cb16afbec6c8cfff89b264f67d7"
  license "Apache-2.0"

  bottle do
    sha256 cellar: :any_skip_relocation, arm64_big_sur: "57571c72929bf97d6992c7c8f7826d6ed1574bc29ace961429ff563524ef8452"
    sha256 cellar: :any_skip_relocation, big_sur:       "a662d57fb34649294ece8d5e75332f73bce6394bf139d31167c4a2a83b3d59e6"
    sha256 cellar: :any_skip_relocation, catalina:      "3a0154264d20257b7376d49be91a9d03f24624fa1e57281cbb79640038e9b1ae"
    sha256 cellar: :any_skip_relocation, mojave:        "16259c0ce60aeba0646452b3f7081a1ad9a7233bf30b3981da24624b781b9790"
    sha256 cellar: :any_skip_relocation, x86_64_linux:  "b245a9e1970ab7d22bfb5ea590d1c736bc3a99a87eb6715ffe7ada252221b4b1"
  end

  depends_on "rust" => :build

  def install
    system "cargo", "install", *std_cargo_args
  end

  test do
    touch testpath/"test.txt"
    cmd = "#{bin}/fselect name from . where name = '*.txt'"
    assert_match "test.txt", shell_output(cmd).chomp
  end
end

"""

import "homebrew-install" as hi

import "rust" as i0

pkg(
  name: "fselect",
  version: "0.7.6",
  description: "Find files with SQL-like queries",
  url: "https://github.com/jhspetersson/fselect",
  metadata: %{
    "license": "Apache-2.0",
    "source": "homebrew",
  },
  dependencies: [hi, i0],

  def install(ctx) {
    ctx.write_file(join(ctx.build, "fselect.rb"), formula)
    ctx.system("homebrew-install", ctx.prefix, ctx.state_dir, "./fselect.rb")
  }
)

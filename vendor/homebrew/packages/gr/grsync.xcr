formula = r"""
class Grsync < Formula
  desc "GUI for rsync"
  homepage "https://www.opbyte.it/grsync/"
  url "https://downloads.sourceforge.net/project/grsync/grsync-1.2.8.tar.gz"
  sha256 "94ea5faca67e3df467b5283377af3cb32b2b47631b6a32d38bc7b371209306b1"
  license "GPL-2.0"

  bottle do
    sha256 arm64_big_sur: "55955b7e18bcb06ad62fa0bca9102901b15b47ae9ea5f69324b987db553cb929"
    sha256 big_sur:       "e5a84736533563fda92cc9173a70b6fed4dd450f75b6280734d069a6e1609139"
    sha256 catalina:      "07f40176b0bfb08d3b461fceb2d4e18f249354ef60a57dd550c11c31d26fee6a"
    sha256 mojave:        "b0bf1fe191950905e46c81953e93a72c6c6c185c146b1a79d09e388348e1c5f1"
    sha256 high_sierra:   "741b7306a6373fc2d86a416a2def2a06c1fd25ab6b30585755faa8326c497c2b"
  end

  depends_on "intltool" => :build
  depends_on "pkg-config" => :build
  depends_on "gettext"
  depends_on "gtk+"

  def install
    system "./configure", "--disable-dependency-tracking",
                          "--disable-unity",
                          "--prefix=#{prefix}"

    system "make", "install"
  end

  test do
    # running the executable always produces the GUI, which is undesirable for the test
    # so we'll just check if the executable exists
    assert_predicate bin/"grsync", :exist?
  end
end

"""

import "homebrew-install" as hi

import "intltool" as i0, "pkg-config" as i1, "gettext" as i2, "gtk+" as i3

pkg(
  name: "grsync",
  version: "1.2.8",
  dependencies: [hi, i0, i1, i2, i3],

  def install(ctx) {
    ctx.write_file(join(ctx.build, "grsync.rb"), formula)
    ctx.system("homebrew-install", ctx.prefix, ctx.state_dir, "./grsync.rb")
  }
)

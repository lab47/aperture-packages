formula = r"""
class CdogsSdl < Formula
  desc "Classic overhead run-and-gun game"
  homepage "https://cxong.github.io/cdogs-sdl/"
  url "https://github.com/cxong/cdogs-sdl/archive/0.12.0.tar.gz"
  sha256 "7ce391e8c9ebd4ca2579ace1bd8d486a8267ff1ec4719c862aba6960ad06bee9"
  license "GPL-2.0-or-later"
  head "https://github.com/cxong/cdogs-sdl.git"

  livecheck do
    url :stable
    strategy :github_latest
  end

  bottle do
    sha256 arm64_big_sur: "2f91d8a55a3b5267771691f5008340ff41acb8f60e3e1be6756f60a2b60e92df"
    sha256 big_sur:       "43a8733426df8a9ec7fc219f44610c2a69f9d0477afb829c860e5feeb6cf33b2"
    sha256 catalina:      "ff7b85e5cd1c7eefaa75b095b6a193453c126113485fb865640c0c671d7c3793"
    sha256 mojave:        "df1a35102836900f1891cd5935c82f42df02ef3e60ed49d03c471981a919571f"
  end

  depends_on "cmake" => :build
  depends_on "pkg-config" => :build
  depends_on "protobuf" => :build
  depends_on "python@3.9"
  depends_on "sdl2"
  depends_on "sdl2_image"
  depends_on "sdl2_mixer"

  def install
    args = std_cmake_args
    args << "-DCDOGS_DATA_DIR=#{pkgshare}/"
    system "cmake", ".", *args
    system "make"
    bin.install %w[src/cdogs-sdl src/cdogs-sdl-editor]
    pkgshare.install %w[data dogfights graphics missions music sounds]
    doc.install Dir["doc/*"]
  end

  test do
    pid = fork do
      exec bin/"cdogs-sdl"
    end
    sleep 7
    assert_predicate testpath/".config/cdogs-sdl",
                     :exist?, "User config directory should exist"
  ensure
    Process.kill("TERM", pid)
  end
end

"""

import "homebrew-install" as hi

import "cmake" as i0, "flac" as i1, "gdbm" as i2, "jpeg" as i3, "libmodplug" as i4, "libogg" as i5, "libpng" as i6, "libtiff" as i7, "libvorbis" as i8, "mpdecimal" as i9, "openssl@1.1" as i10, "pkg-config" as i11, "protobuf" as i12, "python@3.7" as i13, "python@3.8" as i14, "python@3.9" as i15, "readline" as i16, "sdl2" as i17, "sdl2_image" as i18, "sdl2_mixer" as i19, "six" as i20, "sphinx-doc" as i21, "sqlite" as i22, "tcl-tk" as i23, "webp" as i24, "xz" as i25

pkg(
  name: "cdogs-sdl",
  version: "0.12.0",
  dependencies: [hi, i0, i1, i2, i3, i4, i5, i6, i7, i8, i9, i10, i11, i12, i13, i14, i15, i16, i17, i18, i19, i20, i21, i22, i23, i24, i25],

  def install(ctx) {
    ctx.write_file(join(ctx.build, "cdogs-sdl.rb"), formula)
    ctx.system("homebrew-install", ctx.prefix, ctx.state_dir, "./cdogs-sdl.rb")
  }
)

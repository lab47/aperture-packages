formula = r"""
class Whatmp3 < Formula
  include Language::Python::Shebang

  desc "Small script to create mp3 torrents out of FLACs"
  homepage "https://github.com/RecursiveForest/whatmp3"
  url "https://github.com/RecursiveForest/whatmp3/archive/v3.8.tar.gz"
  sha256 "0d8ba70a1c72835663a3fde9ba8df0ff7007268ec0a2efac76c896dea4fcf489"
  license "MIT"
  revision 4
  head "https://github.com/RecursiveForest/whatmp3.git"

  bottle do
    sha256 cellar: :any_skip_relocation, arm64_big_sur: "2508dc07fce36d65efad6e315157faf498789a43e0d8f9eb595ea8122250d6bb"
    sha256 cellar: :any_skip_relocation, big_sur:       "68a5f39de733c7d95679ac3e9c91e9edd543eb9450592a517b2491dd7089641b"
    sha256 cellar: :any_skip_relocation, catalina:      "d449a8bb1339bbc02f27b930a08c21f2acfdbbb49f45dd43ea4015054607244f"
    sha256 cellar: :any_skip_relocation, mojave:        "73e35194bc0eed4cab900ae2436ca67283bddc942d73a77f84e3aa02cf2e518a"
    sha256 cellar: :any_skip_relocation, high_sierra:   "87e78b789996ff11ea55d9224896d581d0aff8a6ad10e14e456588903cf592cb"
  end

  depends_on "flac"
  depends_on "lame"
  depends_on "mktorrent"
  depends_on "python@3.9"

  def install
    system "make", "PREFIX=#{prefix}", "install"

    rewrite_shebang detected_python_shebang, bin/"whatmp3"
  end

  test do
    (testpath/"flac").mkpath
    cp test_fixtures("test.flac"), "flac"
    system "#{bin}/whatmp3", "--notorrent", "--V0", "flac"
    assert_predicate testpath/"V0/test.mp3", :exist?
  end
end

"""

import "homebrew-install" as hi

import "flac" as i0, "gdbm" as i1, "lame" as i2, "libogg" as i3, "mktorrent" as i4, "mpdecimal" as i5, "openssl@1.1" as i6, "pkg-config" as i7, "python@3.9" as i8, "readline" as i9, "sqlite" as i10, "xz" as i11

pkg(
  name: "whatmp3",
  version: "3.8",
  dependencies: [hi, i0, i1, i2, i3, i4, i5, i6, i7, i8, i9, i10, i11],

  def install(ctx) {
    ctx.write_file(join(ctx.build, "whatmp3.rb"), formula)
    ctx.system("homebrew-install", ctx.prefix, ctx.state_dir, "./whatmp3.rb")
  }
)
